#!/usr/bin/env bash

# Get the listening sockets information
listening_sockets=$(sudo netstat -tunlp | awk 'NR>2 {print}')

# Print the header
echo "Active Internet connections (only servers)"
echo "Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name"

# Iterate through each line of the listening sockets
while IFS= read -r line; do
    # Extract the protocol, local address, and PID/Program name from the line
    protocol=$(echo "$line" | awk '{print $1}')
    local_address=$(echo "$line" | awk '{print $4}')
    pid_program=$(echo "$line" | awk '{print $7}')

    # Print the information
    echo "$protocol        $local_address      $pid_program"
done <<< "$listening_sockets"

